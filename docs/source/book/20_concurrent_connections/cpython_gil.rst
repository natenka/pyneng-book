Процессы и потоки в Python (CPython)
------------------------------------

Для начала нам нужно разобраться с терминами:

-  процесс (process) - это, грубо говоря, запущенная программа. Процессу
   выделяются отдельные ресурсы: память, процессорное время
-  поток (thread) - это единица исполнения в процессе. Потоки разделяют
   ресурсы процесса, к которому они относятся.

Python (а точнее, CPython - реализация, которая используется в курсе)
оптимизирован для работы в однопоточном режиме. Это хорошо, если в
программе используется только один поток.

И, в то же время, у Python есть определенные нюансы работы в
многопоточном режиме. Связаны они с тем, что CPython использует GIL
(global interpreter lock).

GIL не дает нескольким потокам исполнять одновременно код Python. Если
не вдаваться в подробности, то GIL можно представить как некий
переходящий флаг, который разрешает потокам выполняться. У кого флаг,
тот может выполнять работу.

Флаг передается либо каждые сколько-то инструкций Python, либо,
например, когда выполняются какие-то операции ввода-вывода.

Поэтому получается, что разные потоки не будут выполняться параллельно,
а программа просто будет между ними переключаться, выполняя их в разное
время.

Но не всё так плохо. Если в программе есть некое "ожидание": пакетов из
сети, запроса пользователя, пауза типа sleep - то в такой программе
потоки будут выполняться как будто параллельно. А всё потому, что во
время таких пауз флаг (GIL) можно передать другому потоку.

Но тут также нужно быть осторожным, так как такой результат может
наблюдаться на небольшом количестве сессий, но может ухудшиться с ростом
количества сессий.

Потоки отлично подходят для задач, которые связаны с операциями
ввода-вывода. Подключение к оборудованию входит в число подобных задач.

В следующих разделах рассматривается, как использовать потоки для
подключения по Telnet/SSH. И проверяется, какое суммарное время будет
занимать исполнение скрипта, по сравнению с последовательным исполнением
и с использованием процессов.

Процессы
--------

Процессы позволяют выполнять задачи на разных ядрах компьютера. Это
важно для задач, которые завязаны на операции ввода-вывода.

Для каждого процесса создается своя копия ресурсов, выделяется память, у
каждого процесса свой GIL. Это же делает процессы более тяжеловесными,
по сравнению с потоками.

Кроме того, количество процессов, которые запускаются параллельно,
зависит от количества ядер и CPU и обычно исчисляется в десятках, тогда
как количество потоков для операций ввода-вывода может исчисляться в
сотнях.

Процессы и потоки можно совмещать, но это усложняет программу и на
базовом уровне для операций ввода-вывода лучше остановиться на потоках.
